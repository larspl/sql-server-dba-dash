<Page
    x:Class="DBADash.ModernUI.Views.SummaryPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="using:DBADash.ModernUI.Controls"
    xmlns:lottie="using:Lottie.WinUI"
    xmlns:charts="using:LiveChartsCore.SkiaSharpView.WinUI"
    Background="{StaticResource DBADashBackgroundBrush}">

    <ScrollViewer>
        <Grid Margin="{StaticResource DBADashPagePadding}">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <!-- Page Header -->
            <Grid Grid.Row="0" Margin="0,0,0,24">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0">
                    <TextBlock
                        Text="Dashboard Overview"
                        Style="{StaticResource DBADashTitleTextStyle}" />
                    <TextBlock
                        Text="Monitor your SQL Server instances at a glance"
                        Style="{StaticResource DBADashCaptionTextStyle}"
                        Margin="0,4,0,0" />
                </StackPanel>

                <!-- Quick Actions -->
                <StackPanel
                    Grid.Column="1"
                    Orientation="Horizontal"
                    Spacing="8">
                    <Button
                        Command="{x:Bind ViewModel.RefreshCommand}"
                        Style="{StaticResource DBADashPrimaryButtonStyle}">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE72C;" FontSize="16" />
                            <TextBlock Text="Refresh" />
                        </StackPanel>
                    </Button>
                    <Button Command="{x:Bind ViewModel.ExportCommand}">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xEDE1;" FontSize="16" />
                            <TextBlock Text="Export" />
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Grid>

            <!-- Summary Cards -->
            <Grid Grid.Row="1" Margin="0,0,0,24">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Grid.ColumnSpacing>16</Grid.ColumnSpacing>

                <!-- Total Instances Card -->
                <Border Grid.Column="0" Style="{StaticResource DBADashCardStyle}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <Grid Grid.Row="0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>

                            <TextBlock
                                Grid.Column="0"
                                Text="Total Instances"
                                Style="{StaticResource DBADashBodyTextStyle}" />
                            <FontIcon
                                Grid.Column="1"
                                Glyph="&#xE968;"
                                FontSize="20"
                                Foreground="{StaticResource DBADashPrimaryBrush}" />
                        </Grid>

                        <TextBlock
                            Grid.Row="1"
                            Text="{x:Bind ViewModel.TotalInstances, Mode=OneWay}"
                            Style="{StaticResource DBADashTitleTextStyle}"
                            Margin="0,8,0,0" />

                        <StackPanel Grid.Row="2" Orientation="Horizontal" Spacing="4" VerticalAlignment="Bottom">
                            <FontIcon
                                Glyph="&#xE74E;"
                                FontSize="12"
                                Foreground="{StaticResource DBADashSuccessBrush}" />
                            <TextBlock
                                Text="{x:Bind ViewModel.ActiveInstances, Mode=OneWay}"
                                Style="{StaticResource DBADashCaptionTextStyle}"
                                Foreground="{StaticResource DBADashSuccessBrush}" />
                            <TextBlock
                                Text="active"
                                Style="{StaticResource DBADashCaptionTextStyle}" />
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- Active Alerts Card -->
                <Border Grid.Column="1" Style="{StaticResource DBADashCardStyle}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <Grid Grid.Row="0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>

                            <TextBlock
                                Grid.Column="0"
                                Text="Active Alerts"
                                Style="{StaticResource DBADashBodyTextStyle}" />
                            <FontIcon
                                Grid.Column="1"
                                Glyph="&#xE7BA;"
                                FontSize="20"
                                Foreground="{StaticResource DBADashErrorBrush}" />
                        </Grid>

                        <TextBlock
                            Grid.Row="1"
                            Text="{x:Bind ViewModel.ActiveAlerts, Mode=OneWay}"
                            Style="{StaticResource DBADashTitleTextStyle}"
                            Foreground="{StaticResource DBADashErrorBrush}"
                            Margin="0,8,0,0" />

                        <StackPanel Grid.Row="2" Orientation="Horizontal" Spacing="4" VerticalAlignment="Bottom">
                            <TextBlock
                                Text="{x:Bind ViewModel.CriticalAlerts, Mode=OneWay}"
                                Style="{StaticResource DBADashCaptionTextStyle}"
                                Foreground="{StaticResource DBADashErrorBrush}" />
                            <TextBlock
                                Text="critical"
                                Style="{StaticResource DBADashCaptionTextStyle}" />
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- Performance Score Card -->
                <Border Grid.Column="2" Style="{StaticResource DBADashCardStyle}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <Grid Grid.Row="0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>

                            <TextBlock
                                Grid.Column="0"
                                Text="Avg Performance"
                                Style="{StaticResource DBADashBodyTextStyle}" />
                            <FontIcon
                                Grid.Column="1"
                                Glyph="&#xEBE7;"
                                FontSize="20"
                                Foreground="{StaticResource DBADashAccentBrush}" />
                        </Grid>

                        <StackPanel Grid.Row="1" Orientation="Horizontal" Spacing="4" Margin="0,8,0,0">
                            <TextBlock
                                Text="{x:Bind ViewModel.PerformanceScore, Mode=OneWay}"
                                Style="{StaticResource DBADashTitleTextStyle}"
                                Foreground="{StaticResource DBADashAccentBrush}" />
                            <TextBlock
                                Text="%"
                                Style="{StaticResource DBADashSubtitleTextStyle}"
                                Foreground="{StaticResource DBADashAccentBrush}"
                                VerticalAlignment="Bottom" />
                        </StackPanel>

                        <StackPanel Grid.Row="2" Orientation="Horizontal" Spacing="4" VerticalAlignment="Bottom">
                            <FontIcon
                                Glyph="{x:Bind ViewModel.PerformanceTrendIcon, Mode=OneWay}"
                                FontSize="12"
                                Foreground="{x:Bind ViewModel.PerformanceTrendColor, Mode=OneWay}" />
                            <TextBlock
                                Text="{x:Bind ViewModel.PerformanceTrend, Mode=OneWay}"
                                Style="{StaticResource DBADashCaptionTextStyle}" />
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- Last Updated Card -->
                <Border Grid.Column="3" Style="{StaticResource DBADashCardStyle}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <Grid Grid.Row="0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>

                            <TextBlock
                                Grid.Column="0"
                                Text="Last Updated"
                                Style="{StaticResource DBADashBodyTextStyle}" />
                            <FontIcon
                                Grid.Column="1"
                                Glyph="&#xE916;"
                                FontSize="20"
                                Foreground="{StaticResource DBADashInfoBrush}" />
                        </Grid>

                        <TextBlock
                            Grid.Row="1"
                            Text="{x:Bind ViewModel.LastUpdatedTime, Mode=OneWay}"
                            Style="{StaticResource DBADashSubtitleTextStyle}"
                            Margin="0,8,0,0" />

                        <TextBlock
                            Grid.Row="2"
                            Text="{x:Bind ViewModel.LastUpdatedDate, Mode=OneWay}"
                            Style="{StaticResource DBADashCaptionTextStyle}"
                            VerticalAlignment="Bottom" />
                    </Grid>
                </Border>
            </Grid>

            <!-- Main Content -->
            <Grid Grid.Row="2">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="2*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Grid.ColumnSpacing>16</Grid.ColumnSpacing>

                <!-- Charts Section -->
                <StackPanel Grid.Column="0" Spacing="16">
                    <!-- Performance Chart -->
                    <Border Style="{StaticResource DBADashCardStyle}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="300" />
                            </Grid.RowDefinitions>

                            <Grid Grid.Row="0" Margin="0,0,0,16">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Column="0"
                                    Text="Performance Overview"
                                    Style="{StaticResource DBADashSubtitleTextStyle}" />

                                <ComboBox
                                    Grid.Column="1"
                                    SelectedIndex="0"
                                    MinWidth="120">
                                    <ComboBoxItem Content="Last 24h" />
                                    <ComboBoxItem Content="Last 7 days" />
                                    <ComboBoxItem Content="Last 30 days" />
                                </ComboBox>
                            </Grid>

                            <!-- LiveCharts2 Chart -->
                            <charts:CartesianChart
                                Grid.Row="1"
                                Series="{x:Bind ViewModel.PerformanceSeries, Mode=OneWay}"
                                XAxes="{x:Bind ViewModel.XAxes, Mode=OneWay}"
                                YAxes="{x:Bind ViewModel.YAxes, Mode=OneWay}" />
                        </Grid>
                    </Border>

                    <!-- Instance Status Chart -->
                    <Border Style="{StaticResource DBADashCardStyle}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="200" />
                            </Grid.RowDefinitions>

                            <TextBlock
                                Grid.Row="0"
                                Text="Instance Status Distribution"
                                Style="{StaticResource DBADashSubtitleTextStyle}"
                                Margin="0,0,0,16" />

                            <!-- Pie Chart -->
                            <charts:PieChart
                                Grid.Row="1"
                                Series="{x:Bind ViewModel.StatusSeries, Mode=OneWay}" />
                        </Grid>
                    </Border>
                </StackPanel>

                <!-- Side Panel -->
                <StackPanel Grid.Column="1" Spacing="16">
                    <!-- Recent Alerts -->
                    <Border Style="{StaticResource DBADashCardStyle}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <TextBlock
                                Grid.Row="0"
                                Text="Recent Alerts"
                                Style="{StaticResource DBADashSubtitleTextStyle}"
                                Margin="0,0,0,16" />

                            <ListView
                                Grid.Row="1"
                                ItemsSource="{x:Bind ViewModel.RecentAlerts, Mode=OneWay}"
                                MaxHeight="300">
                                <ListView.ItemTemplate>
                                    <DataTemplate>
                                        <Grid Margin="0,8">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>

                                            <Border
                                                Grid.Column="0"
                                                Background="{Binding SeverityColor}"
                                                CornerRadius="8"
                                                Width="16"
                                                Height="16"
                                                Margin="0,0,8,0" />

                                            <StackPanel Grid.Column="1">
                                                <TextBlock
                                                    Text="{Binding Message}"
                                                    Style="{StaticResource DBADashBodyTextStyle}"
                                                    TextWrapping="Wrap" />
                                                <TextBlock
                                                    Text="{Binding Timestamp}"
                                                    Style="{StaticResource DBADashCaptionTextStyle}" />
                                            </StackPanel>
                                        </Grid>
                                    </DataTemplate>
                                </ListView.ItemTemplate>
                            </ListView>

                            <HyperlinkButton
                                Grid.Row="2"
                                Content="View all alerts"
                                HorizontalAlignment="Right"
                                Margin="0,8,0,0"
                                Command="{x:Bind ViewModel.ViewAllAlertsCommand}" />
                        </Grid>
                    </Border>

                    <!-- Quick Actions -->
                    <Border Style="{StaticResource DBADashCardStyle}">
                        <StackPanel>
                            <TextBlock
                                Text="Quick Actions"
                                Style="{StaticResource DBADashSubtitleTextStyle}"
                                Margin="0,0,0,16" />

                            <StackPanel Spacing="8">
                                <Button
                                    Command="{x:Bind ViewModel.AddInstanceCommand}"
                                    HorizontalAlignment="Stretch">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <FontIcon Glyph="&#xE710;" />
                                        <TextBlock Text="Add Instance" />
                                    </StackPanel>
                                </Button>

                                <Button
                                    Command="{x:Bind ViewModel.RunHealthCheckCommand}"
                                    HorizontalAlignment="Stretch">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <FontIcon Glyph="&#xE9D9;" />
                                        <TextBlock Text="Run Health Check" />
                                    </StackPanel>
                                </Button>

                                <Button
                                    Command="{x:Bind ViewModel.ViewReportsCommand}"
                                    HorizontalAlignment="Stretch">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <FontIcon Glyph="&#xE8A5;" />
                                        <TextBlock Text="View Reports" />
                                    </StackPanel>
                                </Button>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- System Status -->
                    <Border Style="{StaticResource DBADashCardStyle}">
                        <StackPanel>
                            <TextBlock
                                Text="System Status"
                                Style="{StaticResource DBADashSubtitleTextStyle}"
                                Margin="0,0,0,16" />

                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Row="0" Grid.Column="0"
                                    Text="Data Collection"
                                    Style="{StaticResource DBADashBodyTextStyle}" />
                                <Border
                                    Grid.Row="0" Grid.Column="1"
                                    Style="{StaticResource DBADashSuccessIndicatorStyle}" />

                                <TextBlock
                                    Grid.Row="1" Grid.Column="0"
                                    Text="Repository DB"
                                    Style="{StaticResource DBADashBodyTextStyle}"
                                    Margin="0,8,0,0" />
                                <Border
                                    Grid.Row="1" Grid.Column="1"
                                    Style="{StaticResource DBADashSuccessIndicatorStyle}"
                                    Margin="0,8,0,0" />

                                <TextBlock
                                    Grid.Row="2" Grid.Column="0"
                                    Text="Alert Processing"
                                    Style="{StaticResource DBADashBodyTextStyle}"
                                    Margin="0,8,0,0" />
                                <Border
                                    Grid.Row="2" Grid.Column="1"
                                    Style="{StaticResource DBADashWarningIndicatorStyle}"
                                    Margin="0,8,0,0" />
                            </Grid>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Grid>
        </Grid>
    </ScrollViewer>
</Page>
